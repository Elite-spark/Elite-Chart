<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Elite Spark - Royal Gold</title>
    <script src="https://unpkg.com/lightweight-charts@4.1.1/dist/lightweight-charts.standalone.production.js"></script>
    <style>
        body { margin: 0; background-color: #000; overflow: hidden; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        #chart { width: 100vw; height: 100vh; cursor: crosshair; }
        
        /* العلامة العلوية */
        .chart-info {
            position: absolute; top: 15px; left: 15px; z-index: 10;
            color: #FFD700; pointer-events: none;
        }
        .chart-info h1 { margin: 0; font-size: 18px; letter-spacing: 1px; }
        .chart-info p { margin: 2px 0; font-size: 12px; opacity: 0.8; }

        /* أزرار الرسم */
        .controls {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            z-index: 20; display: flex; gap: 10px;
        }
        .btn {
            background: rgba(255, 215, 0, 0.1); border: 1px solid #FFD700;
            color: #FFD700; padding: 8px 15px; border-radius: 5px; font-size: 12px;
        }
        .btn:active { background: #FFD700; color: #000; }
    </style>
</head>
<body>
    <div class="chart-info">
        <h1>ELITE SPARK</h1>
        <p>XAU/USD - GOLD LIVE</p>
    </div>

    <div class="controls">
        <button class="btn" onclick="addHorizontalLine()">+ خط أفقي</button>
        <button class="btn" onclick="clearLines()">مسح الرسوم</button>
    </div>

    <div id="chart"></div>

    <script>
        // 1. إعداد الشارت باللون الأسود الملكي
        const chart = LightweightCharts.createChart(document.getElementById('chart'), {
            layout: {
                background: { color: '#000000' },
                textColor: '#FFD700', // اللون الذهبي للنصوص
            },
            grid: {
                vertLines: { visible: false }, // إخفاء الشبكة تماماً
                horzLines: { visible: false },
            },
            rightPriceScale: { borderColor: '#FFD700' },
            timeScale: { borderColor: '#FFD700', timeVisible: true },
            handleScroll: { mouseWheel: true, pressedMouseMove: true, horzTouchDrag: true, vertTouchDrag: true },
            handleScale: { axisPressedMouseMove: true, mouseWheel: true, pinch: true },
        });

        // 2. إعداد الشموع (ذهبي صاعد / أسود هابط بحدود ذهبية)
        const candleSeries = chart.addCandlestickSeries({
            upColor: '#FFD700',        // جسم ذهبي للصاعد
            downColor: '#000000',      // جسم أسود للهابط
            borderVisible: true,
            wickVisible: true,
            borderColor: '#FFD700',    // الحدود ذهبية للكل
            wickColor: '#FFD700',      // الذيول ذهبية للكل
            borderUpColor: '#FFD700',
            borderDownColor: '#FFD700',
            wickUpColor: '#FFD700',
            wickDownColor: '#FFD700',
        });

        // 3. جلب البيانات من بينانس
        async function fetchGoldData() {
            try {
                const response = await fetch('https://api.binance.com/api/v3/klines?symbol=PAXGUSDT&interval=30m&limit=150');
                const rawData = await response.json();
                const data = rawData.map(d => ({
                    time: d[0] / 1000,
                    open: parseFloat(d[1]),
                    high: parseFloat(d[2]),
                    low: parseFloat(d[3]),
                    close: parseFloat(d[4])
                }));
                candleSeries.setData(data);
                chart.timeScale().fitContent();
            } catch (e) { console.error("Data Error", e); }
        }

        // 4. ميزة إضافة خطوط الرسم (أفقي كمثال)
        function addHorizontalLine() {
            const price = chart.priceScale('right').coordinateToPrice(100) || 2040;
            const line = candleSeries.createPriceLine({
                price: price,
                color: '#FFD700',
                lineWidth: 2,
                lineStyle: LightweightCharts.LineStyle.Dashed,
                axisLabelVisible: true,
                title: 'دعم/مقاومة',
            });
        }

        function clearLines() {
            location.reload(); // طريقة سريعة لمسح كل شيء والبدء من جديد
        }

        fetchGoldData();
        window.onresize = () => chart.applyOptions({ width: window.innerWidth, height: window.innerHeight });
    </script>
</body>
</html>
